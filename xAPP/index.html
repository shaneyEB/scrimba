<!doctype html>


<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.css">
    <title>XBulletz</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300&display=swap" rel="stylesheet">

    <link rel="icon" type="image/png" sizes="192x192" href="./android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="./favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <link rel="manifest" href="site.webmanifest">
    <link rel="stylesheet" href="index.css">
</head>

<body>
    <header class="header">

        <a href="" class="logo">
            <div class="aligned">
                <img src="icon.png" id="xpic"> <span class="shadow altText"><span class="orange">x</span><span class="grey">B</span>ullet<span class="orange">z</span></span>
                </span>
            </div>
        </a>
        <input class="menu-btn" type="checkbox" id="menu-btn" />
        <label class="menu-icon" for="menu-btn"><span class="navicon"></span></label>
        <ul class="menu">
            <span><a href="#"  id="create">üìùCreate New Entry</a></span>
            <span><a href="#" onclick="tableToCSV()">‚¨áÔ∏èDownLoad CSV</a></span>
        </ul>
    </header>
    <div class="main">
        <div id="about">
            <div class="container">
                <input type="text" id="search" onkeyup="searchX()" placeholder="Search for items.." title="Type in a value of a field">
                <div id='spinIt'></div>
                <div class="toast-overlay" id="toast-overlay"></div>

                <div id="error"></div>
                <div class="rounded">
                    <table id="list"></table>
                </div>
                <button id="xView" type="button" style="margin-top:10px;">
                    View Details
                </button>
            </div>

            <div id="datax" style="overflow-x:auto;">
                <table id="dataTable" class="center" style="display:none;">
                    <thead>
                        <tr id="colHead">
                            <th>Cartridge Name</th>
                            <th>Bullet Weight</th>
                            <th>Bullet Type</th>
                            <th>BC</th>
                            <th>Primer</th>
                            <th>Powder</th>
                            <th>Powder Charge</th>
                            <th>Max Velocity</th>
                            <th>Min Velocity</th>
                            <th>Avg Velocity</th>
                            <th>SD</th>
                            <th colspan="3">Notes</th>
                        </tr>
                    </thead>
                    <tbody id="details"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="myModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
            <div class="modal-header">
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div id="about-modal">
                    <div class="" id="xForm" style="display:none;">
                        <form id="cartridgeForm" class="container">
                            <label for="cartridge">Cartridge Name:</label>
                            <input type="text" id="cartridge" required>
                            <label for="bulletWeight">Bullet Weight:</label>
                            <input type="number" id="bulletWeight" required>
                            <label for="bulletType">Bullet Type:</label>
                            <input type="text" id="bulletType" required>
                            <label for="bc">BC:</label>
                            <input type="text" id="bc" required>
                            <label for="primer">Primer:</label>
                            <input type="text" id="primer" required>
                            <label for="powder">Powder:</label>
                            <input type="text" id="powder" required>
                            <label for="powderCharge">Powder Charge:</label>
                            <input type="number" id="powderCharge" required>
                            <label for="maxVelocity">Max Velocity:</label>
                            <input type="number" id="maxVelocity" required>
                            <label for="minVelocity">Min Velocity:</label>
                            <input type="number" id="minVelocity" required>
                            <label for="avgVelocity">Avg Velocity:</label>
                            <input type="number" id="avgVelocity" readonly>
                            <label for="sd">SD:</label>
                            <input type="number" id="sd" readonly>
                            <label for="notes">Notes:</label>
                            <textarea id="notes" required></textarea>
                            <input type="text" id="idx" hidden>
                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="add-button" class="greenBkg">Save</button> <button id="cancel-button">Cancel</button>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        function searchX() {
            searchTable()
            searchUL()
        }

        function searchTable() {
            var input, filter, tr, i, txtValue, colHead;
            input = document.getElementById("search");
            filter = input.value.toUpperCase();
            tr = document.getElementsByTagName("tr");
            colHead = document.getElementById("colHead")
            for (i = 0; i < tr.length; i++) {
                a = tr[i];
                txtValue = a.textContent || a.innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
            colHead.style.display = ""
        }

        function searchUL() {
            var inputx, filterx, ul, li, a, i, txtValuex;
            inputx = document.getElementById("search");
            filterx = inputx.value.toUpperCase();
            li = document.getElementsByTagName("li");
            for (i = 0; i < li.length; i++) {
                a = li[i];
                txtValuex = a.textContent || a.innerText;
                if (txtValuex.toUpperCase().indexOf(filterx) > -1) {
                    li[i].style.display = "";
                } else {
                    li[i].style.display = "none";
                }
            }
        }

        function capitalizeFirstLetter(string) {
            return string.charAt(0).toUpperCase() + string.slice(1);
        }

        function tableToCSV() {
            let csv_data = [];
            let rows = document.getElementsByTagName('tr');
            for (let i = 0; i < rows.length; i++) {
                let cols = rows[i].querySelectorAll('td,th');
                let csvrow = [];
                for (let j = 0; j < cols.length; j++) {
                    csvrow.push(cols[j].innerHTML);
                }
                csv_data.push(csvrow.join(","));
            }
            csv_data = csv_data.join('\n');
            downloadCSVFile(csv_data);
        }

        function downloadCSVFile(csv_data) {
            CSVFile = new Blob([csv_data], {
                type: "text/csv"
            });
            let temp_link = document.createElement('a');
            temp_link.download = "XBullets.csv";
            let url = window.URL.createObjectURL(CSVFile);
            temp_link.href = url;
            temp_link.style.display = "none";
            document.body.appendChild(temp_link);
            temp_link.click();
            document.body.removeChild(temp_link);
        }
    </script>

    <script src="index.js" type="module"></script>
    <script src="script.js" type="module"></script>

</body>

</html>